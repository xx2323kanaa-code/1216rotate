<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>Left Hand – Phone Hold Demo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:black;
}
body{
  display:flex;
  justify-content:center;
  align-items:center;
}

svg{
  width:100vw;
  max-width:420px;
  height:auto;
}

/* 手首＋手の甲：単一ボリューム（重なりなし） */
.hand-mass{
  fill:rgba(255,255,0,0.25);
  stroke:none;
}

.finger{
  stroke:yellow;
  stroke-width:5;
  stroke-linecap:round;
}

.thumb{
  stroke:yellow;
  stroke-width:5;
  stroke-linecap:round;
  fill:none;
}

.nail{
  fill:yellow;
}

.phone{
  fill:#1e6cff;
  rx:14;
  ry:14;
  opacity:0;
}

.label{
  fill:#aaa;
  font-size:14px;
  text-anchor:middle;
}
</style>
</head>

<body>

<svg viewBox="0 0 360 360">

  <!-- ケータイ（非反転） -->
  <rect id="phone" class="phone"
        x="150" y="135" width="60" height="110"/>

  <!-- 左手（鏡像） -->
  <g id="leftHand" transform="scale(-1,1) translate(-360,0)">

    <!-- 手首＋手の甲：1パス -->
    <path id="handMass" class="hand-mass"
      d="
        M140 185
        Q180 165 220 185
        L220 245
        Q220 270 200 270
        L160 270
        Q140 270 140 245
        Z
      "/>

    <!-- 指 -->
    <g id="fingersGroup">
      <line id="index"  class="finger"/>
      <line id="middle" class="finger"/>
      <line id="ring"   class="finger"/>
      <line id="little" class="finger"/>

      <!-- 親指：2セグメント -->
      <polyline id="thumb" class="thumb"/>

      <!-- 爪 -->
      <polygon id="n_index"  class="nail"/>
      <polygon id="n_middle" class="nail"/>
      <polygon id="n_ring"   class="nail"/>
      <polygon id="n_little" class="nail"/>
      <polygon id="n_thumb"  class="nail"/>
    </g>
  </g>

  <text id="label" x="180" y="35" class="label">RELAX</text>
</svg>

<script>
const baseY = 185;

// 左手用（示指が最長）
const fingers = {
  index:  { x:150, relax:75, hold:36, lock:26 },
  middle: { x:170, relax:72, hold:38, lock:32 },
  ring:   { x:190, relax:68, hold:32, lock:28 },
  little: { x:210, relax:60, hold:30, lock:26 }
};

// 親指：2関節（くの字）
const thumbPos = {
  relax:  [ [230,215],[250,200],[260,185] ],
  hold:   [ [230,215],[240,210],[245,205] ],
  lock:   [ [230,215],[235,220],[238,225] ]
};

const pivotBase = { x:180, y:255 };
const pivotByState = {
  RELAX:{x:0,y:0},
  HOLD:{x:1,y:-1},
  LOCK:{x:2,y:-2}
};

const rotationByState = {
  RELAX:{mass:0,fingers:0},
  HOLD:{mass:4,fingers:12},
  LOCK:{mass:6,fingers:16}
};

const handMass = document.getElementById("handMass");
const fingersGroup = document.getElementById("fingersGroup");
const phone = document.getElementById("phone");
const label = document.getElementById("label");

function nail(id,x,y){
  const s=6;
  document.getElementById(id)
    .setAttribute("points",`${x-s},${y} ${x+s},${y} ${x},${y-s}`);
}

function applyState(state){
  label.textContent = state;
  phone.style.opacity = state==="RELAX" ? 0 : 1;

  const pivot = {
    x: pivotBase.x + pivotByState[state].x,
    y: pivotBase.y + pivotByState[state].y
  };

  // 手首は回らない：手の甲だけ軽く
  handMass.setAttribute(
    "transform",
    `rotate(${rotationByState[state].mass} ${pivot.x} ${pivot.y})`
  );
  fingersGroup.setAttribute(
    "transform",
    `rotate(${rotationByState[state].fingers} ${pivot.x} ${pivot.y})`
  );

  for(const id in fingers){
    const f=fingers[id];
    const len =
      state==="RELAX"?f.relax:
      state==="HOLD"?f.hold:
      f.lock;

    const el=document.getElementById(id);
    el.setAttribute("x1",f.x);
    el.setAttribute("y1",baseY);
    el.setAttribute("x2",f.x);
    el.setAttribute("y2",baseY-len);

    const n=document.getElementById("n_"+id);
    if(state==="RELAX"){
      nail("n_"+id,f.x,baseY-len);
      n.style.opacity=1;
    }else{
      n.style.opacity=0;
    }
  }

  // 親指（くの字）
  const pts = thumbPos[state].map(p=>p.join(",")).join(" ");
  document.getElementById("thumb").setAttribute("points",pts);

  const tn=document.getElementById("n_thumb");
  if(state==="RELAX"){
    const p=thumbPos.relax[2];
    nail("n_thumb",p[0],p[1]);
    tn.style.opacity=1;
  }else{
    tn.style.opacity=0;
  }
}

const seq=["RELAX","HOLD","LOCK","HOLD","RELAX"];
let i=0;
setInterval(()=>{
  applyState(seq[i]);
  i=(i+1)%seq.length;
},2600);

applyState("RELAX");
</script>

</body>
</html>
